---
alwaysApply: true
---

# Производительность и безопасность

## Производительность

### Память

- `viewModelScope.launch` для корутин с автоматической отменой при очистке
- `StateFlow` с `SharingStarted.WhileSubscribed` (таймаут 5000мс) в DetailScreenViewModel
- `rememberSaveable` для сохранения состояния при реконфигурации

### БД

- Room DAO с Flow для реактивных запросов
- `searchItems` с LIKE без индексов (текущее состояние)

### UI

- `LazyColumn` с `key = { it.id }` для стабильной идентификации (MainScreen.kt:376)
- `rememberLazyListState()` для сохранения состояния прокрутки
- `verticalScroll(rememberScrollState())` для форм
- `rememberSaveable` для локального состояния (title, details, selectedDate, selectedColor)

## Безопасность

### Данные

- `TextField` с `minLines` для ограничения ввода (detailsSection.kt:199)
- Room для безопасного хранения данных
- Безопасное разворачивание опционалов: `checkNotNull`, `?.let`, `?:`

### Файлы

- ImportBackupUseCase: обработка `FileNotFoundException`, `IOException`, `SerializationException`, `SQLException`
- JSON с `ignoreUnknownKeys = true` для игнорирования неизвестных полей
- Фильтрация дубликатов при импорте по title/details/timestamp/displayOption
- `contentResolver.openInputStream()` с автоматическим закрытием через `use`
