# Экран 1.1: Root Screen (Корневой экран с TabBar)

## Обзор

Root Screen является основным экраном приложения с нижней навигацией. Он обеспечивает переключение между основными разделами приложения через TabBar.

## Назначение

Основной экран приложения с нижней навигацией, обеспечивающий переключение между вкладками "События" и "Ещё".

## Компоненты

1. **Bottom Navigation Bar** — нижняя навигация с двумя вкладками
2. **Контейнер для содержимого** — отображение содержимого выбранной вкладки
3. **Управление состоянием** — управление активной вкладкой через ViewModel

## Вкладки

- **Вкладка "События"** — главный список записей (Main Screen)
- **Вкладка "Ещё"** — дополнительные функции и настройки (More Screen)

## Навигация

- Переключение между вкладками через Bottom Navigation Bar
- Активация вкладки "События" по умолчанию при запуске
- Использование Navigation Compose для управления навигацией

## Зависимости от других этапов

- Нет зависимостей — это базовый экран навигации

---

## Подробный план реализации по TDD

### Шаг 1: Подготовка тестовой среды

#### Задачи:
1. Создать модульные тесты для ViewModel корневого экрана
2. Настроить MockK для мокирования зависимостей
3. Подготовить тестовые данные для вкладок

#### Критерии готовности:
- ✅ Тестовая среда настроена
- ✅ MockK интегрирован
- ✅ Тестовые данные подготовлены

---

### Шаг 2: Реализация модели данных для вкладок

#### Задачи:
1. Создать sealed class для определения вкладок (Events, More)
2. Добавить свойства: route, icon, titleResId (ID строкового ресурса для локализации)
3. Написать тесты для проверки корректности создания вкладок

#### Структура:
```kotlin
sealed class Screen(
    val route: String,
    val icon: ImageVector,
    val titleResId: Int, // ID строкового ресурса для локализации
) {
    object Events : Screen(
        route = "events",
        icon = Icons.Filled.List,
        titleResId = R.string.events,
    )

    object More : Screen(
        route = "more",
        icon = Icons.Filled.MoreVert,
        titleResId = R.string.more,
    )
}
```

**Примечание:** Использование `titleResId` вместо хардкод-строк обеспечивает правильную локализацию. В UI строки получаются через `stringResource(id = screen.titleResId)`.

#### Критерии готовности:
- ✅ Sealed class создан
- ✅ Свойства добавлены (route, icon, titleResId)
- ✅ Используются строковые ресурсы для локализации
- ✅ Unit-тесты написаны и проходят

---

### Шаг 3: Реализация ViewModel с логикой переключения вкладок

#### Задачи:
1. Создать RootScreenViewModel
2. Реализовать начальное состояние (вкладка "События" активна по умолчанию)
3. Реализовать метод для переключения вкладок
4. Написать unit-тесты:
   - `whenViewModelCreated_thenDefaultTabIsActive()`
   - `whenSwitchToEventsTab_thenEventsTabIsActive()`
   - `whenSwitchToMoreTab_thenMoreTabIsActive()`
   - `whenInvalidTab_thenNoChange()`

#### Критерии готовности:
- ✅ ViewModel создан
- ✅ Начальное состояние установлено
- ✅ Метод переключения реализован
- ✅ Unit-тесты написаны и проходят

---

### Шаг 4: Реализация UI-состояния

#### Задачи:
1. Создать data class для представления состояния UI
2. Добавить свойства: текущая вкладка, список вкладок
3. Написать тесты для проверки корректности состояния

#### Критерии готовности:
- ✅ UI State создан
- ✅ Свойства добавлены
- ✅ Тесты написаны и проходят

---

### Шаг 5: Реализация Composable функции для навигации

#### Задачи:
1. Создать RootScreen composable
2. Реализовать NavigationBar с двумя пунктами (Material Design 3)
3. Подключить к ViewModel для управления состоянием
4. Использовать Navigation Compose для отображения содержимого вкладок
5. Реализовать синхронизацию состояния вкладок с навигационным стеком
6. Применить Material Design 3 компоненты
7. Использовать корректные иконки из Material Icons

#### Критерии готовности:
- ✅ RootScreen composable создан
- ✅ NavigationBar реализован
- ✅ Интеграция с ViewModel работает
- ✅ Навигация настроена
- ✅ Material Design 3 применен

---

### Шаг 6: Применение темы

#### Задачи:
1. Использовать тему приложения с поддержкой темного режима
2. Обеспечить корректное отображение элементов в обеих темах

#### Критерии готовности:
- ✅ Тема применена
- ✅ Темный режим работает корректно

---

### Шаг 7: Финальное тестирование

#### Задачи:
1. Проверить все сценарии работы ViewModel
2. Убедиться в корректной работе переключения вкладок
3. Проверить, что вкладка "События" активна по умолчанию
4. Проверить обработку ошибок и крайних случаев в логике переключения вкладок

#### Критерии готовности:
- ✅ Все тесты проходят
- ✅ Переключение вкладок работает корректно
- ✅ Обработка ошибок реализована

---

## Реализация (детали)

### UI компоненты
- Использовать Navigation Compose для управления навигацией
- Создать sealed class для определения вкладок (Screen)
- Реализовать NavigationBar с двумя пунктами (Material Design 3)
- Управление состоянием вкладок с помощью ViewModel
- Обработка событий переключения вкладок
- Синхронизация состояния ViewModel с навигационным стеком
- Использовать современные компоненты Material Design 3
- Применить тему приложения с поддержкой темного режима
- Применить корректные иконки из Material Icons
- Реализовать верстку компонентов навигации:
  - Использовать NavigationBar для нижней навигации
  - Добавить иконки и текстовые метки для вкладок
  - Обеспечить визуальное выделение активной вкладки
  - Обеспечить корректное поведение при изменении ориентации экрана (автоматически через Compose)

### Архитектура
- Использовать Navigation Compose для управления навигацией
- Реализовать Repository Pattern для абстракции источников данных (если требуется)
- Использовать Flow для реактивного обновления UI (если требуется)
- Применить Clean Architecture (Data → Domain → Presentation)

---

## Тестирование

### Unit-тесты
- Тесты для ViewModel (логика переключения вкладок)
- Тесты для UI State
- Тесты для Screen sealed class

### Интеграционные тесты
- Тесты взаимодействия ViewModel с навигацией
- Тесты синхронизации состояния

### UI-тесты
- Проверить переключение между вкладками
- Проверить, что вкладка "События" активна по умолчанию при запуске
- Проверить корректность работы ViewModel
- Проверить обработку ошибок и крайних случаев в логике переключения вкладок

---

## Критерии завершения этапа

Этап считается завершенным, когда:

- ✅ Все компоненты созданы и работают
- ✅ Все unit-тесты написаны и проходят
- ✅ Все интеграционные тесты написаны и проходят
- ✅ Код соответствует правилам проекта
- ✅ Линтеры не выдают ошибок
- ✅ Навигация работает корректно
- ✅ Тема применена корректно

---

## Блокируемые этапы

После завершения этого экрана можно приступать к:
- Экран 2.1: Главный экран (требует навигацию)
- Экран 5.1: More Screen (требует навигацию)

---

## Примечания

1. **Material Design 3**: Использовать современные компоненты Material Design 3 для навигации.

2. **Состояние**: Управление состоянием вкладок должно быть синхронизировано с навигационным стеком.

3. **Тестирование**: Все компоненты должны быть покрыты тестами перед использованием в других этапах.

4. **Тема**: Применение темы должно поддерживать светлый и темный режимы.

5. **Локализация**: Использовать готовые строковые ресурсы из `Localization_Plan.md`:
   - Названия вкладок: `events`, `more`
   - Все строки определены и готовы к использованию
   - Screen использует `titleResId` для локализации заголовков экранов
   - В UI строки получаются через `stringResource(id = screen.titleResId)`
