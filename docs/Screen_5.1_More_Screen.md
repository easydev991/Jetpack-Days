# Экран 5.1: More Screen (Ещё)

## Обзор

More Screen является экраном с дополнительными функциями и настройками приложения. Экран предоставляет доступ к настройкам темы и иконки, управлению данными, а также к внешним ссылкам и функциям обратной связи.

## Назначение

Экран с дополнительными функциями и настройками приложения, включая настройки темы и иконки, управление данными, отправку отзыва и ссылки на внешние ресурсы.

## Компоненты

1. **Заголовок экрана** — "Ещё" (используется из NavigationBar, не дублируется)

2. **Список кнопок настроек и действий**:

   - **Кнопка "Тема и иконка"** — Переход к экрану Screen 5.2 (ThemeIcon Screen)
   - **Кнопка "Данные приложения"** — Переход к экрану Screen 5.3 (AppData Screen)
   - **Кнопка "Отправить отзыв"** — Открывает почтовый клиент/форму обратной связи
   - **Кнопка "Оценить приложение"** — Ссылка на страницу в Google Play для оценки
   - **Кнопка "Поделиться приложением"** — ShareSheet с ссылкой на приложение в Google Play
   - **Кнопка "Страница на GitHub"** — Ссылка на репозиторий приложения

3. **Текст версии приложения** (внизу экрана)

   - Формат: "Версия приложения: X.Y.Z" (локализован через stringResource)

## Навигация

- "Тема и иконка" → Screen 5.2 (ThemeIcon Screen)
- "Данные приложения" → Screen 5.3 (AppData Screen)

## Зависимости от других этапов

- ✅ **Экран 1.1: Root Screen** — уже реализован, навигация к More Screen настроена
- ⚠️ **Экран 5.2: ThemeIcon Screen** — должен быть реализован для навигации (опционально)
- ⚠️ **Экран 5.3: AppData Screen** — должен быть реализован для навигации (опционально)

---

## Подробный план реализации по TDD

### Шаг 1: Структура и навигация

**Статус:** ⚠️ Частично выполнено

#### 1.1. Создание файла экрана

**Задачи:**

1. ~~Создать отдельный файл `MoreScreen.kt` в `ui/screen/`~~ - Требуется, в данный момент компонент находится в `RootScreenComponents.kt`
2. ~~Вынести `moreScreenContent()` из RootScreen.kt в отдельный компонент~~ - Уже реализовано в `RootScreenComponents.kt` (строки 187-209), но только как заглушка
3. Добавить маршруты для экранов 5.2 и 5.3 в navigation/Screen.kt (ThemeIcon, AppData) - Требуется

**Текущее состояние:**

- ✅ Заглушка `moreScreenContent()` существует в `RootScreenComponents.kt` (строки 187-209)
- ✅ Маршрут Screen.More уже существует в navigation/Screen.kt (строки 23-27)
- ❌ Нет отдельного файла MoreScreen.kt
- ❌ Нет маршрутов для ThemeIcon и AppData экранов
- ⚠️ Заглушка отображает только текст "Экран настроек не реализован"

**Критерии готовности:**

- ✅ Файл MoreScreen.kt создан
- ✅ Компонент вынесен из RootScreenComponents.kt
- ✅ Маршруты ThemeIcon и AppData добавлены в Screen.kt

---

#### 1.2. Настройка навигации

**Задачи:**

1. Реализовать навигацию к экрану "Тема и иконка" (Screen 5.2) - Требуется
2. Реализовать навигацию к экрану "Данные приложения" (Screen 5.3) - Требуется
3. Обновить navHostContent в RootScreenComponents.kt для добавления маршрутов ThemeIcon и AppData - Требуется

**Текущее состояние:**

- ✅ Навигационная панель с двумя вкладками (Events, More) уже настроена
- ✅ Базовая навигация к экрану More уже работает
- ❌ Нет навигации к ThemeIcon и AppData экранам

**Критерии готовности:**

- ✅ Навигация к экранам настроена
- ✅ Переходы работают корректно
- ✅ NavHost содержит маршруты ThemeIcon и AppData

---

### Шаг 2: Реализация UI компонентов

**Статус:** ❌ Не начат

#### 2.1. Создание списка кнопок

**Задачи:**

1. Заменить заглушку в `moreScreenContent()` на полноценную реализацию UI
2. Создать список кнопок с соответствующими иконками из Material Icons:

   - Icons.Default.Palette для "Тема и иконка"
   - Icons.Default.Storage для "Данные приложения"
   - Icons.Default.Email для "Отправить отзыв"
   - Icons.Default.Star для "Оценить приложение"
   - Icons.Default.Share для "Поделиться приложением"
   - Icons.Default.Public для "GitHub страница"

3. Реализовать верстку компонентов экрана:

   - Использовать вертикальный Column с LazyColumn для основного макета
   - Добавить список кнопок с иконками и текстовыми метками
   - Обеспечить визуальное разделение между группами элементов (spacing: 16dp)
   - Добавить отображение версии приложения внизу экрана (foregroundStyle: secondary)
   - Обеспечить адаптивность компоновки при изменении ориентации экрана (аналог iOS ViewThatFits)

**Текущее состояние:**

- ❌ Только заглушка с текстом "Экран настроек не реализован"
- ❌ Нет кнопок с иконками
- ❌ Нет адаптивной верстки

**Критерии готовности:**

- ✅ Заглушка заменена на полноценный UI
- ✅ Список кнопок создан с Material Icons
- ✅ Верстка выполнена с LazyColumn
- ✅ Адаптивность обеспечена
- ✅ Верстка идентична iOS для единообразия UX

---

### Шаг 3: Реализация функциональности

**Статус:** ❌ Не начат

#### 3.1. Отправка отзыва

**Задачи:**

1. Реализовать отправку отзыва (открытие почтового клиента/формы обратной связи)
2. Использовать Intent.ACTION_SENDTO для отправки email
3. Обработать случаи, когда почтовый клиент не установлен

**Текущее состояние:**

- ❌ Не реализовано

**Критерии готовности:**

- ✅ Отправка отзыва работает через Intent
- ✅ Обработка ошибок реализована (клиент не установлен)

---

#### 3.2. Оценка приложения

**Задачи:**

1. Реализовать оценку приложения (открытие страницы в Google Play)
2. Использовать Google Play URL (play.google.com/store/apps/details?id=<package_name>)
3. Обработать случаи, когда Google Play не доступен

**Текущее состояние:**

- ❌ Не реализовано

**Критерии готовности:**

- ✅ Оценка приложения работает через Intent.ACTION_VIEW
- ✅ Обработка ошибок реализована

---

#### 3.3. Шеринг приложения

**Задачи:**

1. Реализовать шеринг приложения (ShareSheet с ссылкой на Google Play)
2. Использовать Intent.ACTION_SEND для шеринга
3. Обработать случаи ошибок

**Текущее состояние:**

- ❌ Не реализовано

**Критерии готовности:**

- ✅ Шеринг работает через Intent
- ✅ Обработка ошибок реализована

---

#### 3.4. Открытие GitHub репозитория

**Задачи:**

1. Реализовать открытие GitHub репозитория (открытие ссылки в браузере)
2. Использовать Intent.ACTION_VIEW для открытия URL
3. Обработать случаи ошибок

**Текущее состояние:**

- ❌ Не реализовано

**Критерии готовности:**

- ✅ Открытие GitHub работает через Intent
- ✅ Обработка ошибок реализована

---

#### 3.5. Отображение версии приложения

**Задачи:**

1. Отобразить текущую версию приложения (получение из BuildConfig.VERSION_NAME)
2. Форматировать версию через stringResource(R.string.app_version, BuildConfig.VERSION_NAME)

**Текущее состояние:**

- ❌ Не реализовано

**Критерии готовности:**

- ✅ Версия отображается внизу экрана
- ✅ Форматирование работает корректно с локализованным ресурсом

---

### Шаг 4: Локализация

**Статус:** ✅ Выполнен

**Задачи:**

1. ~~Использовать готовые строковые ресурсы из `Localization_Plan.md`:~~

   - ~~Заголовок экрана: `more`~~ - ✅ Уже используется в Screen.kt
   - ~~Названия кнопок: `app_theme_and_icon`, `app_data`, `send_feedback`, `rate_the_app`, `share_the_app`, `github_page`~~ - ✅ Уже существуют в strings.xml
   - ~~Формат версии приложения: `app_version` (с параметром)~~ - ✅ Уже существует в strings.xml

2. ~~Поддержка русского и английского языков~~ - ✅ Уже реализована в `Localization_Plan.md`

**Текущее состояние:**

- ✅ Все строковые ресурсы существуют в `values/strings.xml`, `values-ru/strings.xml`, `values-en/strings.xml`
- ✅ Локализация уже реализована и интегрирована в проект
- ✅ Ключи ресурсов: `app_version`, `send_feedback`, `rate_the_app`, `share_the_app`, `github_page`, `app_data`, `app_theme_and_icon`

**Критерии готовности:**

- ✅ Используются готовые строковые ресурсы
- ✅ Локализация работает корректно

**Примечание:** Все строки определены в `Localization_Plan.md` (Шаги 1-6 выполнены). Необходимо только интегрировать их в MoreScreen.kt.

---

### Шаг 5: Финальное тестирование

**Статус:** ❌ Не начат

**Задачи:**

1. Проверить переход к экрану "Тема и иконка" (UI тесты)
2. Проверить переход к экрану "Данные приложения" (UI тесты)
3. Проверить открытие почтового клиента для отзыва (UI тесты)
4. Проверить открытие Google Play для оценки (UI тесты)
5. Проверить функцию шеринга (UI тесты)
6. Проверить открытие GitHub репозитория (UI тесты)
7. Проверить отображение версии приложения (UI тесты)
8. Написать unit-тесты для логики открытия Intents

**Текущее состояние:**

- ❌ Нет UI тестов
- ❌ Нет unit тестов

**Критерии готовности:**

- ✅ Все тесты проходят
- ✅ Все функции работают корректно

---

## Реализация (детали)

### UI компоненты

- ~~Использовать ScrollView для прокрутки содержимого (scrollBounceBehavior: basedOnSize)~~ → LazyColumn с параметром contentPadding
- Реализовать адаптивную верстку (аналог iOS ViewThatFits):

  - Горизонтальная верстка (LazyHorizontalGrid): две колонки кнопок (если позволяет ширина экрана)
  - Вертикальная верстка (LazyColumn): одна колонка кнопок (если ширина экрана недостаточная)
  - Использовать WindowWidthSizeClass для определения размера экрана

- Добавить список кнопок с иконками и текстовыми метками
- Обеспечить визуальное разделение между группами элементов (Spacer, Divider)
- Добавить отображение версии приложения внизу экрана (Text с LocalContentAlpha.medium)
- Обеспечить адаптивность компоновки при изменении ориентации экрана (ConfigurationListener)
- Использовать современные компоненты Material Design 3 (MaterialTheme, Card, ListItem)
- Применить тему приложения с поддержкой темного режима (MaterialTheme.colorScheme)
- Применить корректные иконки из Material Icons (Icons.Default.*)
- Верстка идентична iOS для единообразия UX

### Архитектура

- MoreScreen не требует ViewModel (простой экран без состояния)
- Использовать composable-функции с параметрами для навигации
- NavHostController передается через параметры или из LocalNavController
- Обработка ошибок происходит в UI-слое через try-catch для Intent действий
- ~~Clean Architecture (Data → Domain → Presentation), если требуется для будущих функций~~ → Не требуется для этого экрана

---

## Тестирование

### Unit-тесты

- ~~Тесты для логики получения версии приложения~~ → Не требуется (используется BuildConfig.VERSION_NAME)
- Тесты для обработки ошибок внешних ссылок (Intents)
- Тесты для форматирования версии приложения с stringResource

### UI-тесты

- Проверить наличие всех кнопок на экране
- Проверить переход к экрану "Тема и иконка"
- Проверить переход к экрану "Данные приложения"
- Проверить открытие почтового клиента для отзыва
- Проверить открытие Google Play для оценки
- Проверить функцию шеринга
- Проверить открытие GitHub репозитория
- Проверить отображение версии приложения
- Проверить адаптивность верстки при изменении ориентации

---

## Критерии завершения этапа

Этап считается завершенным, когда:

- ✅ Файл MoreScreen.kt создан и функционален
- ✅ Все UI компоненты реализованы
- ✅ Все функции (отправка отзыва, оценка, шеринг, GitHub) работают
- ✅ Навигация к ThemeIcon и AppData экранам работает
- ✅ Все строковые ресурсы локализованы
- ✅ Все unit-тесты написаны и проходят
- ✅ Все UI-тесты написаны и проходят
- ✅ Код соответствует правилам проекта
- ✅ Линтеры не выдают ошибок
- ✅ Навигация работает корректно
- ✅ Все внешние ссылки работают корректно

---

## Блокируемые этапы

После завершения этого этапа можно приступать к:

- Экран 5.2: ThemeIcon Screen (требует навигацию из More Screen)
- Экран 5.3: AppData Screen (требует навигацию из More Screen)

---

## Текущее состояние реализации

**На основе анализа кода от января 2026 года:**

### Выполнено

- ✅ Экран Root Screen реализован и работоспособен
- ✅ Навигационная панель с двумя вкладками (Events, More) настроена
- ✅ Маршрут Screen.More определен в navigation/Screen.kt
- ✅ Заглушка moreScreenContent() реализована в RootScreenComponents.kt
- ✅ Все строковые ресурсы для локализации существуют (values/strings.xml, values-ru/strings.xml, values-en/strings.xml)
- ✅ Локализация интегрирована в проект (Localization_Plan.md шаги 1-6 выполнены)

### Не выполнено

- ❌ Отсутствует отдельный файл MoreScreen.kt (компонент в RootScreenComponents.kt)
- ❌ moreScreenContent() содержит только заглушку "Экран настроек не реализован"
- ❌ Нет маршрутов ThemeIcon и AppData в navigation/Screen.kt
- ❌ Нет UI компонентов (кнопки с иконками, список, адаптивная верстка)
- ❌ Не реализована функциональность (отправка отзыва, оценка, шеринг, GitHub)
- ❌ Не отображается версия приложения
- ❌ Нет unit тестов
- ❌ Нет UI тестов

### Приоритет задач

1. **Высокий приоритет:** Создание файла MoreScreen.kt и базовой верстки UI
2. **Высокий приоритет:** Добавление маршрутов ThemeIcon и AppData
3. **Средний приоритет:** Реализация функциональности кнопок (отправка, шеринг и т.д.)
4. **Низкий приоритет:** Написание тестов

---

## Примечания

1. **Внешние ссылки**: Все внешние ссылки должны обрабатывать случаи, когда соответствующие приложения не установлены или недоступны. Использовать try-catch для Intent действий.

2. **Версия приложения**: Версия должна получаться из BuildConfig.VERSION_NAME для автоматического обновления. Форматирование через stringResource(R.string.app_version, BuildConfig.VERSION_NAME).

3. **Тестирование**: Все компоненты должны быть покрыты тестами перед использованием в других этапах.

4. **Зависимости**: Реализация зависит от завершения Экрана 1.1 (Root Screen) - ✅ выполнено.

5. **Архитектура**: MoreScreen не требует ViewModel из-за отсутствия сложного состояния. Использовать Stateless подход с передачей параметров.

6. **Локализация**: Все строки уже существуют в проекте, необходимо только использовать их в коде (stringResource).

7. **Адаптивность**: Использовать WindowWidthSizeClass для определения размера экрана и адаптации верстки (аналог iOS ViewThatFits).
